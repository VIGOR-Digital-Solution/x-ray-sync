(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8888:function(l,e,t){Promise.resolve().then(t.bind(t,6257))},6257:function(l,e,t){"use strict";var i=t(7437),a=t(932),n=t(3191),o=t(5524),d=t(8472),s=t(2265);let u=l=>{let{onClick:e,disabled:t,children:a}=l;return(0,i.jsx)("button",{onClick:e,disabled:t,className:"px-4 py-2 font-bold text-white rounded ".concat(t?"bg-gray-400 cursor-not-allowed":"bg-blue-500 hover:bg-blue-700"," mr-2"),children:a})},c=l=>{let{backendUrl:e}=l,[t,d]=(0,s.useState)(""),[c,m]=(0,s.useState)(""),[x,b]=(0,s.useState)(""),{data:h}=(0,a.a)({queryFn:()=>v(e),queryKey:["settings"],enabled:!!e}),p=(0,n.NL)(),{mutate:f}=(0,o.D)({mutationFn:l=>r(e,null==l?void 0:l.title,null==l?void 0:l.value),onSettled:async()=>{await p.invalidateQueries({queryKey:["settings"]}),await p.invalidateQueries({queryKey:["logs"]})}});return(0,s.useEffect)(()=>{if(h){var l,e,t,i,a,n;d(null===(e=h.data)||void 0===e?void 0:null===(l=e.find(l=>(null==l?void 0:l.title)==="txt_file_location"))||void 0===l?void 0:l.value),m(null===(i=h.data)||void 0===i?void 0:null===(t=i.find(l=>(null==l?void 0:l.title)==="juki_file_location"))||void 0===t?void 0:t.value),b(null===(n=h.data)||void 0===n?void 0:null===(a=n.find(l=>(null==l?void 0:l.title)==="panacim_file_location"))||void 0===a?void 0:a.value)}},[h]),(0,i.jsxs)("div",{className:"p-4",children:[(0,i.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Settings"}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{htmlFor:"txtLocation",className:"block mb-2",children:"TXT File Location:"}),(0,i.jsx)("input",{id:"txtLocation",type:"text",value:t,onChange:l=>d(l.target.value),className:"w-full px-3 py-2 border rounded mb-4"})]}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{htmlFor:"jukiLocation",className:"block mb-2",children:"JUKI Import Location:"}),(0,i.jsx)("input",{id:"jukiLocation",type:"text",value:c,onChange:l=>m(l.target.value),className:"w-full px-3 py-2 border rounded mb-4"})]}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{htmlFor:"panacimLocation",className:"block mb-2",children:"PanaCIM Import Location:"}),(0,i.jsx)("input",{id:"panacimLocation",type:"text",value:x,onChange:l=>b(l.target.value),className:"w-full px-3 py-2 border rounded mb-4"})]}),(0,i.jsx)(u,{onClick:()=>{f({title:"txt_file_location",value:t}),f({title:"juki_file_location",value:c}),f({title:"panacim_file_location",value:x})},children:"Save Settings"})]})};function v(l){return d.Z.get("".concat(l,"/settings"))}function r(l,e,t){return d.Z.put("".concat(l,"/settings/").concat(e),{value:t})}e.default=()=>{var l,e,t,m,x,b,h,p,f;let[j,y]=(0,s.useState)(""),[g,N]=(0,s.useState)(!1),{data:_}=(0,a.a)({queryFn:()=>d.Z.get("".concat(j,"/logs")),queryKey:["logs"],refetchInterval:1e3,enabled:!!j}),{data:k}=(0,a.a)({queryFn:()=>v(j),queryKey:["settings"],enabled:!!j});(0,s.useEffect)(()=>{y("".concat(window.location.protocol,"//").concat(window.location.hostname,":4006"))},[]);let w=(0,n.NL)(),{mutate:L}=(0,o.D)({mutationFn:l=>r(j,null==l?void 0:l.title,null==l?void 0:l.value),onSettled:async()=>{await w.invalidateQueries({queryKey:["settings"]}),await w.invalidateQueries({queryKey:["logs"]})}}),S=null==k?void 0:null===(e=k.data)||void 0===e?void 0:null===(l=e.find(l=>(null==l?void 0:l.title)==="state"))||void 0===l?void 0:l.value,C=null==k?void 0:null===(m=k.data)||void 0===m?void 0:null===(t=m.find(l=>(null==l?void 0:l.title)==="txt_file_location"))||void 0===t?void 0:t.value,F=null==k?void 0:null===(b=k.data)||void 0===b?void 0:null===(x=b.find(l=>(null==l?void 0:l.title)==="juki_file_location"))||void 0===x?void 0:x.value,q=null==k?void 0:null===(p=k.data)||void 0===p?void 0:null===(h=p.find(l=>(null==l?void 0:l.title)==="panacim_file_location"))||void 0===h?void 0:h.value,I=null==_?void 0:null===(f=_.data)||void 0===f?void 0:f.map(l=>({...l,timestamp:new Date((null==l?void 0:l.timestamp)*1e3).toLocaleString()}));return(0,i.jsxs)("div",{className:"p-4 max-w-4xl mx-auto",children:[(0,i.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"X-Ray Sync"}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)(u,{onClick:()=>N(!g),children:g?"Back to Main":"Settings"}),!g&&(0,i.jsx)(u,{onClick:()=>{"active"===S?L({title:"state",value:"inactive"}):L({title:"state",value:"active"})},disabled:!S&&!C&&!F&&!q,children:"active"===S?"OFF":"ON"})]}),g?(0,i.jsx)(c,{backendUrl:j}):(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{className:"mb-4",children:["Current TXT Location: ",C]}),(0,i.jsxs)("p",{className:"mb-4",children:["JUKI Import Location: ",F]}),(0,i.jsxs)("p",{className:"mb-4",children:["PanaCIM Import Location: ",q]}),(0,i.jsxs)("div",{className:"mt-4",children:[(0,i.jsx)("h2",{className:"text-xl font-bold mb-2",children:"Process Logs:"}),(0,i.jsx)("div",{className:"bg-gray-100 p-2 rounded h-64 overflow-y-auto",children:null==I?void 0:I.map(l=>(0,i.jsxs)("p",{className:"mb-1",children:["[",null==l?void 0:l.timestamp,"] ",null==l?void 0:l.message]},null==l?void 0:l.id))})]})]})]})}}},function(l){l.O(0,[832,260,971,23,744],function(){return l(l.s=8888)}),_N_E=l.O()}]);